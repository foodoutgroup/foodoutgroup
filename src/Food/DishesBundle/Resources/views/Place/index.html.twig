{% extends 'FoodAppBundle::layout.html.twig' %}

{% block title %}{% trans with {'%restaurant_name%':place.name} %}general.restaurant_page_title{% endtrans %}{% if place.getSEO('Title') %} {{ place.getSEO('Title') }}{% endif %} | {{page_title }}{% endblock %}
{% block seo_description %}{{ place.getSEO('Description') }}{% endblock %}

{% block adnet_retargeting %}
    {% if track_conversions %}
        <!-- Adform Tracking Code BEGIN -->
        <script type="text/javascript">
            var _adftrack = {
                pm: 314127,
                divider: encodeURIComponent('|'),
                pagename: encodeURIComponent('Foodout.lt|{% trans %}general.places{% endtrans %}|{{ place.name }}')
            };
            (function () { var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = 'https://track.adform.net/serving/scripts/trackpoint/async/'; var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x); })();

        </script>
        <noscript>
            <p style="margin:0;padding:0;border:0;">
                <img src="https://track.adform.net/Serving/TrackPoint/?pm=314127&ADFPageName=Foodout.lt|{% trans %}general.places{% endtrans %}|{{ place.name }}&ADFdivider=|" width="1" height="1" alt="" />
            </p>
        </noscript>
        <!-- Adform Tracking Code END -->
    {% endif %}
{% endblock %}

{% block ga_js_code %}

    $(document).ready(
        function() {
            $('body').delegate('.order-button', 'click', function(){
                ga('ec:setAction', 'checkout_option', {'step': 1});
            });
        }
    );
{% endblock %}

{% block body %}
    {# Facebook ViewContent Begin #}
    <script>fbq('track', 'ViewContent');</script>
    {# Facebook ViewContent End #}
    {% javascripts '@FoodAppBundle/Resources/public/js_main/place.js' %}
    <script src="{{ asset_url }}"></script>
    <script type="application/javascript">
        Place.listTypeSaveUrl = '{{ path('food_place_menu_layout') }}';
        Place.placePointDataUrl = '{{ path('food_place_point_data') }}';
        Place.translations = {
            'payments_cash': '{% trans %}places.payments.cash{% endtrans %}',
            'payments_card': '{% trans %}places.payments.card{% endtrans %}',
            'payments_online': '{% trans %}places.payments.online{% endtrans %}'
        };
    </script>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key={{ google_maps_api }}&sensor=false"></script>
    {% endjavascripts %}

    {% include 'FoodDishesBundle:Place:dish_cart_partial.html.twig' %}


{#
    <!-- Add fancyBox main JS and CSS files -->
    <script type="text/javascript" src="/bundles/foodapp/scripts/fancy/jquery.fancybox.js?v=2.1.5"></script>
    <link rel="stylesheet" type="text/css" href="/bundles/foodapp/scripts/fancy/jquery.fancybox.css?v=2.1.5" media="screen" />

    <!-- Add Button helper (this is optional) -->
    <link rel="stylesheet" type="text/css" href="/bund;es/foodapp/scripts/fancy/helpers/jquery.fancybox-buttons.css?v=1.0.5" />
    <script type="text/javascript" src="/bundles/foodapp/scripts/fancy/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>

    <!-- Add Thumbnail helper (this is optional) -->
    <link rel="stylesheet" type="text/css" href="/bundles/foodapp/scripts/fancy/helpers/jquery.fancybox-thumbs.css?v=1.0.7" />
    <script type="text/javascript" src="/bundles/foodapp/scripts/fancy/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>

    <!-- Add Media helper (this is optional) -->
    <script type="text/javascript" src="/bundles/foodapp/scripts/fancy/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
#}
    <div style="background-image: url(/bundles/foodapp/images/inner-bg.jpg);" class="site-center image-top">
        <div class="site-block">
            <div class="page-path clearfix"><a href="{{ path('food_homepage') }}">{% trans %}places.home{% endtrans %}</a>{# TODO breadcrumbs <a href="#">Restoranai arti Žirmūnų</a>#}<a href="#">{{ place.name }}</a></div>
            <div class="page-title">
                <h1 class="clearfix"><span>{{ place.name }}{% if place.slogan is not empty %} - {{ place.slogan }}{% endif %}</span>
                    <div data-stars="{{ place.averageRating }}" class="restoran-rating fl"></div>
                </h1>
            </div>
                <div class="clearfix">
                    <div class="content-lefter-big">
                        <div id="detailed-restaurant" class="detailed-resturant">
                        <ul>
                            <li><a href="#detailed-restaurant-menu">{% trans %}places.menu{% endtrans %}</a></li>
                            {#<li><a href="#detailed-restaurant-review">{% trans %}places.reviews{% endtrans %}</a></li>#}
                            <li class="last restaurant-info-tab"><a href="#detailed-restaurant-info">{% trans %}places.information{% endtrans %}</a></li>
                        </ul>
                        <div id="detailed-restaurant-menu" class="detailed-restaurant-menu">
                            <div class="clearfix">
                                <div class="menu-lefter" id="catmnu">
                                    <div class="dropdown">
                                        <button id="dLabel" class="button" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            {% trans %}places.food_categories{% endtrans %}
                                            <span class="caret"></span>
                                        </button>
                                        <ul class="dropdown-menu scrollable-menu menu" aria-labelledby="dLabel">
                                            {% for category in placeCategories %}
                                                {% if category.dishes and dishService.activeDishesByCategory(category.id)|length > 0 %}
                                                    <li {# {% if category.id == selectedCategory.id %} class="active"{% endif %} #}>
                                                        <a href="#{{ slug_util.slugByItem(category.id, 'food_category') }}">{{ category.name }}<span>{{ category.activeDishesCount }}</span></a>
                                                    </li>
                                                {% endif %}
                                            {% endfor %}
                                        </ul>
                                    </div>

                                    {% if place.id == 63 and site_country == 'LT' %}
                                        {# Link to Cili Express #}
                                        <div class="express-button">
                                            <a href="{{ path('food_cili_greita') }}">
                                                <img alt="Čili greita" src="{{ asset('bundles/foodapp/images/cili-greitai-button.png') }}" />
                                            </a>
                                        </div>
                                    {% endif %}
                                </div>
                        {# Meniu #}
                                <div class="menu-righter">
                                    {% if placePointsAll|length == 1 %}
                                        {% if isTodayNoOneWantsToWork == true %}
                                            <div class="alert alert-danger">
                                                {{ order_service.workTimeErrorsReturn(placePointsAll[0])|trans }}
                                            </div>
                                        {% endif %}
                                    {% endif %}
                                    {% if place.selfDelivery and app.user is not empty and app.user.isBussinesClient %}
                                        <div class="alert alert-danger">
                                            {% trans %}places.discount_not_for_business_clients{% endtrans %}
                                        </div>
                                    {% endif %}
                                    <div class="menu-title clearfix">
                                        {% if place.showNotification %}
                                            <div class="alert alert-danger" id="notificationNotice">
                                                {{ place.notificationContent|raw }}
                                            </div>
                                            <Script>
                                                $(document).ready(function(){
                                                    setTimeout(function(){ $('#notificationNotice').fadeOut();}, 15000);
                                                });
                                            </Script>
                                        {% endif %}

                                        {# Dish Search Begin #}
                                        <div class="dish_search_block">
                                            <select class="dish_category_select" data-placeholder="{% trans %}places.dish_category_select{% endtrans %}">
                                                <option value=""></option>
                                                {% for dishCategory in placeCategories %}
                                                    {% if dishCategory.dishes and dishService.activeDishesByCategory(dishCategory.id)|length > 0 %}
                                                        <option value="{{ dishCategory.id }}">{{ dishCategory.name }}</option>
                                                    {% endif %}
                                                {% endfor %}
                                            </select>
                                            <input type="text" class="dish_search_input" value="" placeholder="{% trans %}places.dish_search_input{% endtrans %}" />
                                        </div>
                                        {# Dish Search End #}

                                        <h2 class="fl">{% trans %}places.dishes_title{% endtrans %}{# {{ selectedCategory.name }} #}</h2>
                                        <div class="view-type clearfix">
                                            {% if listType == 'thumbs' %}
                                            <a href="#" class="ico-thumbs active"></a><a href="#" class="ico-list"></a>
                                            {% else %}
                                            <a href="#" class="ico-thumbs"></a><a href="#" class="ico-list active"></a>
                                            {% endif %}
                                        </div>
                                    </div>
                                    {# {{ render(controller('FoodDishesBundle:FoodCategory:dishList', {'categoryId': selectedCategory.id, 'listType': listType})) }} #}
                                    {% for dishCategory in placeCategories %}
                                        {{ render(controller('FoodDishesBundle:FoodCategory:dishList', {'categoryId': dishCategory.id, 'category': dishCategory, 'listType': listType})) }}
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                        {# Atsiliepimai #}
                        {#<div id="detailed-restaurant-review" class="detailed-restaurant-review">
                            <div class="review-title clearfix">
                                &#123;&#35; TODO temporary reviews are not shown &#35;&#125;
                                &#123;&#35;<h3>{{ place.reviewCount }} {% transchoice place.reviews.count %}places.review_choice{% endtranschoice %}</h3>&#35;&#125;
                                {% if (wasHere and not alreadyWrote) or not app.user %}
                                    <a href="{% if app.user %}#place-review-popup{% else %}#login-register-popup{% endif %}" class="fancy-box">{% trans %}places.add_review{% endtrans %}</a>
                                {% endif %}
                                {{ include('FoodDishesBundle:Place:review-popup.html.twig') }}
                            </div>
                            <div class="review-list">
                                &#123;&#35; TODO temporary reviews are not shown &#35;&#125;
                                &#123;&#35;{% for review in place.reviews %}
                                <div class="review-item clearfix">
                                    <div class="review-person"><img src="/bundles/foodapp/images/person.png">
                                        <p class="name">{{ review.createdBy.getFirstname }}</p>
                                        {% if review.createdBy.getDefaultAddress %}
                                            <p class="location">{{ review.createdBy.getDefaultAddress.city }}</p>
                                        {% endif %}
                                    </div>
                                    <div class="review-baloon">
                                        <div class="nip"></div>
                                        <p class="text">{{ review.review }}</p>
                                        <div class="clearfix">
                                            <div data-stars="{{ review.rate }}" class="restoran-rating fl"></div>
                                            <div class="date fr">{{ review.createdAt|localizeddate('medium', 'none', locale) }}</div>
                                        </div>
                                    </div>
                                </div>
                                {% endfor %}&#35;&#125;
                            </div>
                            &#123;&#35;<div class="paginator clearfix"><a href="#" class="prev"></a><a href="#" class="active">1</a><a href="#">2</a><a href="#">3</a><a href="#">4</a><a href="#">5</a><a href="#">6</a><a href="#" class="next"></a></div>&#35;&#125;
                        </div>#}
                        {# Restorano informacija #}
                        <div id="detailed-restaurant-info" class="detailed-restaurant-info">
                            <h3>{% trans %}places.about_place{% endtrans %}</h3>
                            <div class="clearfix">
                                <div class="restaurant-info-lefter">
                                    <ul class="menu">
                                        <li class="ico-kitchen">
                                            <strong>{% trans %}places.kitchen{% endtrans %}:</strong>
                                            {% for kitchen in place.kitchens %}
                                                {% if loop.index != 1 %}, {% endif %}{{ kitchen.name }}
                                            {% endfor %}
                                        </li>
                                        <li class="ico-pickup">
                                            <strong>{% trans %}place.pickup_info{% endtrans %}:</strong>{{ place.pickupTime }}
                                        </li>
                                        {% if place.deliveryOptions != 'pickup' %}
                                            <li class="ico-time">
                                                <strong>{% trans %}places.delivery_time{% endtrans %}:</strong>{{ places_service.getDeliveryTime(place) }}
                                                {% if place.deliveryTimeInfo is not empty %}
                                                    <span class="delivery-time-info ui-icon ui-icon-info" title="{{ place.deliveryTimeInfo }}"></span>
                                                {% endif %}
                                            </li>
                                            <li class="ico-delivery"><strong>{% trans %}places.delivery_price{% endtrans %}:</strong>
                                                {% set minPrc = places_service.minDeliveryPrice(place.id) %}
                                                {% set maxPrc = places_service.maxDeliveryPrice(place.id) %}
                                                {% if minPrc == maxPrc %}
                                                    {{ currency_display|raw }}{{ minPrc }}
                                                {% else %}
                                                    {{ currency_display|raw }}{{ minPrc }}-{{ maxPrc }}
                                                {% endif %}
                                            </li>
                                            <li class="ico-cart"><strong>{% trans %}places.minimal_cart{% endtrans %}:</strong>
                                                {% set minCart = places_service.minCartPrice(place.id) %}
                                                {% set maxCart = places_service.maxCartPrice(place.id) %}
                                                {% if minCart == maxCart %}
                                                    {{ currency_display|raw }}{{ minCart }}
                                                {% else %}
                                                    {{ currency_display|raw }}{{ minCart }}-{{ maxCart }}
                                                {% endif %}
                                            </li>
                                        {% endif %}
                                        <li class="ico-payments hidden"><strong>{% trans %}places.payment_types{% endtrans %}:</strong><span class="payments-data"></span></li>
                                        {% if place.deliveryOptions != 'pickup' %}
                                            <li class="ico-delivery"><strong>{% trans %}places.card_on_delivery{% endtrans %}:</strong>{% if place.cardOnDelivery == 1 %}{{ 'yes'|trans }}{% else %}{{ 'no'|trans }}{% endif %}</li>
                                        {% endif %}
                                    </ul>
                                </div>
                                <div class="restaurant-info-righter simple-content">
                                    {% if placePoints is not empty %}
                                        <label for="place-select">{% trans %}places.select_place_point{% endtrans %}:</label>
                                        <select id="place-select" class="custom-select">
                                            {% for point in placePoints%}
                                                <option value="{{ point.id }}">{{ point.address }}, {{ point.city }}</option>
                                            {% endfor %}
                                        </select>
                                        <div class="location-work-hours clearfix">
                                            <div class="lefter" id="restaurant-map-location" style="height: 300px;width: 300px;"></div>
                                            <div class="righter">
                                                <h3>{% trans %}places.work_hours{% endtrans %}:</h3>
                                                <table class="work-times">
                                                    <tr>
                                                        <td>{% trans %}general.monday{% endtrans %}</td>
                                                        <td class="tar wd1"><span>10:00 - 24:00</span></td>
                                                    </tr>
                                                    <tr>
                                                        <td>{% trans %}general.tuesday{% endtrans %}</td>
                                                        <td class="tar wd2"> <span>10:00 - 24:00</span></td>
                                                    </tr>
                                                    <tr>
                                                        <td>{% trans %}general.wednesday{% endtrans %}</td>
                                                        <td class="tar wd3"> <span>10:00 - 24:00</span></td>
                                                    </tr>
                                                    <tr>
                                                        <td>{% trans %}general.thursday{% endtrans %}</td>
                                                        <td class="tar wd4"> <span>10:00 - 24:00</span></td>
                                                    </tr>
                                                    <tr>
                                                        <td>{% trans %}general.friday{% endtrans %}</td>
                                                        <td class="tar wd5"> <span>10:00 - 24:00</span></td>
                                                    </tr>
                                                    <tr>
                                                        <td>{% trans %}general.saturday{% endtrans %}</td>
                                                        <td class="tar wd6"> <span>10:00 - 24:00</span></td>
                                                    </tr>
                                                    <tr>
                                                        <td>{% trans %}general.sunday{% endtrans %}</td>
                                                        <td class="tar wd7"> <span>10:00 - 24:00</span></td>
                                                    </tr>
                                                </table>
                                            </div>
                                        </div>
                                    {% endif %}
                                    <p class="restaurant-description">{{ place.description|raw|nl2br }}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="content-righter-small">
                    {{ render(controller('FoodCartBundle:Default:sideBlock', {'place': place })) }}
                </div>
            </div>
        </div>
    </div>

    <script type="application/javascript">
        $(document).ready(function(){
            Place.initWindowScroll();
        });
    </script>
    {# Zavalas Popup Begin #}
    {% if places_service.isShowZavalDeliveryTime(place) %}
        {% if site_country == 'LT' %}
            <!-- This site is converting visitors into subscribers and customers with OptinMonster - http://optinmonster.com :: Campaign Title: [LT] Zavalas -->
            <div id="om-nkcu3qstsjxkdv12-holder"></div><script>var nkcu3qstsjxkdv12,nkcu3qstsjxkdv12_poll=function(){var r=0;return function(n,l){clearInterval(r),r=setInterval(n,l)}}();!function(e,t,n){if(e.getElementById(n)){nkcu3qstsjxkdv12_poll(function(){if(window['om_loaded']){if(!nkcu3qstsjxkdv12){nkcu3qstsjxkdv12=new OptinMonsterApp();return nkcu3qstsjxkdv12.init({"u":"11462.367922","staging":0,"dev":0,"beta":0});}}},25);return;}var d=false,o=e.createElement(t);o.id=n,o.src="//a.optnmnstr.com/app/js/api.min.js",o.onload=o.onreadystatechange=function(){if(!d){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){try{d=om_loaded=true;nkcu3qstsjxkdv12=new OptinMonsterApp();nkcu3qstsjxkdv12.init({"u":"11462.367922","staging":0,"dev":0,"beta":0});o.onload=o.onreadystatechange=null;}catch(t){}}}};(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(o)}(document,"script","omapi-script");</script>
            <!-- / OptinMonster -->
        {% elseif site_country == 'LV' %}
            <!-- This site is converting visitors into subscribers and customers with OptinMonster - http://optinmonster.com :: Campaign Title: [LV] Zavalas -->
            <div id="om-xx1z1otqbssjrm1t-holder"></div><script>var xx1z1otqbssjrm1t,xx1z1otqbssjrm1t_poll=function(){var r=0;return function(n,l){clearInterval(r),r=setInterval(n,l)}}();!function(e,t,n){if(e.getElementById(n)){xx1z1otqbssjrm1t_poll(function(){if(window['om_loaded']){if(!xx1z1otqbssjrm1t){xx1z1otqbssjrm1t=new OptinMonsterApp();return xx1z1otqbssjrm1t.init({"u":"11462.367923","staging":0,"dev":0,"beta":0});}}},25);return;}var d=false,o=e.createElement(t);o.id=n,o.src="//a.optnmnstr.com/app/js/api.min.js",o.onload=o.onreadystatechange=function(){if(!d){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){try{d=om_loaded=true;xx1z1otqbssjrm1t=new OptinMonsterApp();xx1z1otqbssjrm1t.init({"u":"11462.367923","staging":0,"dev":0,"beta":0});o.onload=o.onreadystatechange=null;}catch(t){}}}};(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(o)}(document,"script","omapi-script");</script>
            <!-- / OptinMonster -->
        {% endif %}
    {% endif %}
    {# Zavalas Popup End #}
{% endblock %}
